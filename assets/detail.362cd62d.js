var H=Object.defineProperty,U=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var P=(r,a,e)=>a in r?H(r,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[a]=e,D=(r,a)=>{for(var e in a||(a={}))Y.call(a,e)&&P(r,e,a[e]);if($)for(var e of $(a))q.call(a,e)&&P(r,e,a[e]);return r},A=(r,a)=>U(r,W(a));import{_ as G,j as E,s as J,c as _,y as z,o as u,l as C,a as m,w as s,b as l,A as j,i as N,p as f,F as I,H as Z,Y as K,G as B,d as Q,u as o,e as d,t as h,Z as L,$ as X,x as ee,O as te,C as ae,a0 as oe,I as se,a1 as le,V as ne,f as ie,h as re,a2 as ce,a3 as ue,a4 as de}from"./index.3ddb0175.js";import{B as pe}from"./index.3b729402.js";import{M as fe}from"./index.5bad56d8.js";import{s as ge,a as me}from"./home.7b2f5623.js";import"./request.304a15fc.js";const he=d("Responses"),_e=d("mdi-content-save"),ve=d("Complete this Task"),ye=d("Responses"),ke={style:{width:"100%",height:"280px"}},Ve=d("Complete This Task"),be={name:"MapResponseView"},we=Object.assign(be,{props:{cate:{type:Array,default:()=>[]},id:{type:String,default:""},latlng:{type:Object,default:()=>({})}},setup(r){const a=r,e=E(),t=J(),M=_(()=>[A(D({},a.latlng),{click:!1}),{locLng:t.value.lng,locLat:t.value.lat,click:!1,customIcon:!1}]),b=_(()=>{const{locLng:n,locLat:i}=a.latlng;return t.value&&(n||i)?w(t.value,{lng:n,lat:i}):0});z(()=>{x()});function v(n){return a.cate.includes(n)}const y=J("");async function c(n){n=n||{message:y.value};const i=a.id,p=await ge(i,n);console.log(p),n.completed&&e.back()}function x(){navigator.geolocation.getCurrentPosition(n=>{const{latitude:i,longitude:p}=n.coords;t.value={lat:i,lng:p}},n=>{console.log(n)},{enableHighAccuracy:!0})}function w(n,i,p=!1){let k=JSON.parse(JSON.stringify(n)),V=JSON.parse(JSON.stringify(i)),R,O,F=6378137;k.lat=k.lat*Math.PI/180,V.lat=V.lat*Math.PI/180,R=k.lat-V.lat,O=(k.lng-V.lng)*Math.PI/180;let g,T,S;return T=Math.sin(R/2),S=Math.sin(O/2),g=2*F*Math.asin(Math.sqrt(T*T+Math.cos(k.lat)*Math.cos(V.lat)*S*S)),g=Math.round(g*1e4)/1e4,g=p?g/1e3:g,g.toFixed(2)}return(n,i)=>(u(),C(I,null,[v("loan-due")?(u(),m(N,{key:0},{title:s(()=>[he]),text:s(()=>[l(j,{label:"This is the reason 1",color:"primary",value:"this-is-the-reason-1","hide-details":""}),l(j,{label:"This is the reason 2",color:"primary",value:"this-is-the-reason-2","hide-details":""})]),_:1})):f("v-if",!0),v("casual-chat")?(u(),C(I,{key:1},[l(K,{filled:"",label:"Response message input here","auto-grow":"",modelValue:y.value,"onUpdate:modelValue":i[1]||(i[1]=p=>y.value=p),rows:"2"},{append:s(()=>[l(Z,{onClick:i[0]||(i[0]=p=>c(null))},{default:s(()=>[_e]),_:1})]),_:1},8,["modelValue"]),l(B,{block:"",onClick:i[2]||(i[2]=p=>c({completed:!0}))},{default:s(()=>[ve]),_:1})],64)):f("v-if",!0),v("confirm-gps-location")?(u(),C(I,{key:2},[l(N,null,{title:s(()=>[ye]),text:s(()=>[Q("div",ke,[l(fe,{data:o(M),"remove-controls":["zoom","local"]},null,8,["data"])]),d(" The distance between my location and previous recorded shop location is "+h(o(b))+" meter ",1),l(L,{items:["Yes","No"],label:"Are you in front of shop?"}),o(b)>20?(u(),m(L,{key:0,items:["My mobile phone has bad GPS signal ","The previous recorded GPS location is wrong"],label:"Why the distance is > 20 Meters"})):f("v-if",!0),l(L,{items:["My Location","Previous recorded shop location"],label:"Which location is more accurate"})]),_:1}),l(B,{block:"",color:"success",onClick:i[3]||(i[3]=p=>c({completed:!0}))},{default:s(()=>[Ve]),_:1})],64)):f("v-if",!0)],64))}});var Ce=G(we,[["__file","D:/tapp/ftma_app2/src/views/Tasks/component/MapResposeView.vue"]]);const Ie=d(" Go to Agent View "),Me={name:"TaskDetail"},xe=Object.assign(Me,{setup(r){const a=X(),e=ee({id:a.params.id,info:null,loading:!0}),t=_(()=>e.info||{}),M=_(()=>t.value.color),b=_(()=>{const c=t.value.category;return c?{"loan-due":["loan-due","casual-chat"],"casual-chat":["casual-chat"],"confirm-gps-location":["confirm-gps-location"]}[c]:[]}),v=_(()=>({locLat:t.value.locLat,locLng:t.value.locLng,color:t.value.color,id:t.value.taskId}));z(async()=>{e.loading=!0;const c=y();e.info=await me(e.id),e.info.mode="response",c&&(e.info.category=c.category,e.info.mode=c.mode),e.loading=!1}),te(()=>{sessionStorage.removeItem("item")});function y(){try{return JSON.parse(sessionStorage.getItem("item"))}catch{return null}}return(c,x)=>(u(),C(I,null,[o(e).loading?(u(),m(ae,{key:0,class:"position-absolute",style:{top:"38%",left:"46%","z-index":"9999"},indeterminate:"",color:"green"})):f("v-if",!0),l(pe,{"bg-color":o(M)},null,8,["bg-color"]),o(e).loading?f("v-if",!0):(u(),m(N,{key:1},{default:s(()=>[l(oe,{src:"",height:"100",class:se([`bg-${o(t).color}`,"align-center"])},{default:s(()=>[l(re,{lines:"two"},{default:s(()=>[l(le,null,{default:s(()=>[l(ne,{class:"text-h4 text-white"},{default:s(()=>{var w;return[d(h((w=o(t).category)==null?void 0:w.toUpperCase()),1)]}),_:1}),l(ie,{class:"text-grey-darken-5"},{default:s(()=>[d(h(o(t).taskId),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["class"]),l(ce,{"primary-title":""},{default:s(()=>[d(h(o(t).agentName)+" / "+h(o(t).agentId),1)]),_:1}),o(t).category!=="confirm-gps-location"?(u(),m(ue,{key:0,class:"text-grey-darken-3"},{default:s(()=>[d(h(o(t).description),1)]),_:1})):f("v-if",!0),o(t).mode==="readonly"?(u(),m(de,{key:1},{default:s(()=>[l(B,{variant:"outlined",to:`/agent/${o(t).agentId}`},{default:s(()=>[Ie]),_:1},8,["to"])]),_:1})):f("v-if",!0)]),_:1})),o(t).mode!=="readonly"?(u(),m(Ce,{key:2,id:o(t).taskId,cate:o(b),latlng:o(v)},null,8,["id","cate","latlng"])):f("v-if",!0)],64))}});var Oe=G(xe,[["__file","D:/tapp/ftma_app2/src/views/Tasks/detail.vue"]]);export{Oe as default};
