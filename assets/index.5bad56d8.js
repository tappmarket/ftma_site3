var U=Object.defineProperty;var w=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var P=(e,t,o)=>t in e?U(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,$=(e,t)=>{for(var o in t||(t={}))R.call(t,o)&&P(e,o,t[o]);if(w)for(var o of w(t))Z.call(t,o)&&P(e,o,t[o]);return e};var b=(e,t)=>{var o={};for(var a in e)R.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(e!=null&&w)for(var a of w(e))t.indexOf(a)<0&&Z.call(e,a)&&(o[a]=e[a]);return o};import{s as v,_ as V,c as A,L as H,M as W,x as F,N as G,O as Q,P as X,o as B,l as z,d as N,b as M,G as q,Q as O,F as J,R as K,a as Y,w as x,p as ee,S as te,T as I,U as j,W as oe,X as ae,u as ne}from"./index.3ddb0175.js";const n=v(),D=v();function re(e,f){var u=f,{center:t={lat:39.61,lng:-105.02},zoom:o=10}=u,a=b(u,["center","zoom"]);const{lat:l,lng:c}=t,s=$({center:[l,c],zoom:o},a);n.value=L.map(e,s),L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(n.value),ue()}function le(){n.value&&n.value.remove()}function se(e,t=!0,o){if((e==null?void 0:e.length)===0)return null;const a=e.map(({id:l="-1",lat:c,lng:s,color:_="blue",customIcon:g=!0,click:m=!0})=>{if(g===!1){const C=L.marker([c,s]);return C.__id=l,o==null||o(C,m),C}const k=`<svg style="width: 40px;height:40px" viewBox="0 0 24 20">
    <path fill="${_}" d="M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5M12,2A7,7 0 0,0 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9A7,7 0 0,0 12,2Z" />
  </svg>`,S=ie({svg:k}),h=L.marker([c,s],{icon:S});return h.__id=l,o==null||o(h,m),h}),f=new L.featureGroup(a).addTo(n.value);t&&n.value.fitBounds(f.getBounds());function u(){f.clearLayers()}return{group:f,markerList:a,clear:u}}function ue(){L.Control.LocalControl=L.Control.extend({options:{position:"topleft"},initialize(t={}){L.Util.extend(this.options,t)},onAdd(t){const o=document.createElement("div");return o.appendChild(D.value.$el),o},onRemove(t){}}),L.control.localControl=t=>new L.Control.LocalControl(t);const e=L.control.localControl();n.value.localControl=e,e.addTo(n.value)}function ce({lat:e,lng:t}={}){return L.marker([e,t]).addTo(n.value)}function ie({svg:e}){return L.divIcon({html:e,className:"",iconSize:[40,40],iconAnchor:[24,40]})}const de={name:"BaseMap"},fe=Object.assign(de,{props:{latlng:{type:Array,default:()=>[]},sheetHeight:{type:[Number,String],default:0},showCurrentLocate:{type:Boolean,default:!1},locate:{type:Object,default:()=>({})},removeControls:{type:Array,default:()=>[]}},setup(e){const t=e,o=v(),a=v(),f=v(),u=v(!0),l=A(()=>t.latlng),c=A(()=>parseFloat(t.sheetHeight)/2);H(l,()=>{var r,i,d;if(((r=l.value)==null?void 0:r.length)===0){n.value.locate({setView:!0});return}a.value="",(i=f.value)==null||i.forEach(p=>{var y;return(y=n.value)==null?void 0:y.removeLayer(p)}),((d=l.value)==null?void 0:d.length)!==0&&h(l.value)}),H(a,()=>{a.value&&n.value?(n.value.dragging.disable(),n.value.scrollWheelZoom.disable()):(n.value.dragging.enable(),n.value.scrollWheelZoom.enable())}),W(()=>{g()});const s=F({click:!1,wheelOrControl:!1,locate:!1});G(()=>{var r;o.value&&(re("map",{zoom:0,scrollWheelZoom:"center",wheelPxPerZoomLevel:120,preferCanvas:!0,renderer:L.canvas()}),_(t.removeControls),(r=n.value)==null||r.doubleClickZoom.disable(),h(l.value),n.value.on("click",i=>{a.value&&(a.value="",n.value.panBy({x:0,y:-1*c.value}),s.click=!1)}),n.value.on("zoomend",S))}),Q(()=>{g(),le()});function _(r){if(r.length===0)return;const i={zoom:()=>n.value.zoomControl.remove(),local:()=>n.value.localControl.remove()};r.forEach(d=>{var p;return(p=i[d])==null?void 0:p.call(i)})}function g(){a.value&&(a.value="",n.value.panBy({x:0,y:-1*c.value}))}const m=X("refreshMarker",()=>{}),k=C(m);function S(){if(s.locate){s.locate=!1;return}if(u.value=!1,!s.click&&s.wheelOrControl===!1){s.wheelOrControl++;const r=n.value.getZoom(),i=n.value.getCenter();k({center:i,distance:r,status:s.wheelOrControl,success(){setTimeout(()=>{s.wheelOrControl=!1,u.value=!0},400)}})}}function h(r){if((r==null?void 0:r.length)===0)return;const{markerList:i}=se(r,u.value,(d,p)=>{!d||!p||d.on("click",y=>{s.click=!0,a.value=d.__id,n.value.setView(y.latlng,10),setTimeout(()=>{n.value.panBy({x:0,y:c.value})},300)})});f.value=i}function C(r,i=1e3){let d=null;return(...p)=>{d&&(clearTimeout(d),d=null),d=setTimeout(()=>r.call(null,...p),i)}}const T=v();function E(){if(!T.value&&(s.locate=!0,t.showCurrentLocate)){const r=t.locate;T.value=ce(r),n.value.setView(r,16)}}return(r,i)=>(B(),z(J,null,[N("div",{id:"map",ref_key:"mapRef",ref:o},null,512),M(q,{icon:"mdi-crosshairs-gps ",size:"x-small",ref_key:"localControlRef",ref:D,onClick:E},null,512),O(r.$slots,"bottomSheet",{props:a.value},void 0,!0)],64))}});var pe=V(fe,[["__scopeId","data-v-2e6f40e4"],["__file","D:/tapp/ftma_app2/src/components/BaseMap/index.vue"]]);const ve=K({name:"BottomSheet",props:{show:{type:Boolean,default:!1},data:{type:Object,default:()=>({})}}}),me={key:0,class:"transition-fast-in-fast-out v-card--reveal"};function he(e,t,o,a,f,u){return B(),Y(oe,{modelValue:e.show,"onUpdate:modelValue":t[0]||(t[0]=l=>e.show=l)},{default:x(({isHovering:l,props:c})=>[N("div",I(j(c)),[M(te,null,{default:x(()=>[l?(B(),z("div",me,[O(e.$slots,"default",{data:e.data},void 0,!0)])):ee("v-if",!0)]),_:2},1024)],16)]),_:3},8,["modelValue"])}var _e=V(ve,[["render",he],["__scopeId","data-v-27bed977"],["__file","D:/tapp/ftma_app2/src/components/BottomSheet/index.vue"]]);const ge={class:"map-h"},Ce={name:"Map"},ye=Object.assign(Ce,{props:{data:{type:Array,default:()=>[]},bottomSheetHeight:{type:[Number,String],default:0},showCurrentLocate:{type:Boolean,default:!1},latlng:{type:Object,default:()=>({})},removeControls:{type:Array,default:()=>[]}},setup(e){const t=e,o=A(()=>t.data.map(g=>{var m=g,{locLat:u,locLng:l,color:c,id:s}=m,_=b(m,["locLat","locLng","color","id"]);return $({lat:u,lng:l,color:c,id:s},_)})||[]),a=v(!1);function f(u){return u?(a.value=!0,t.data.find(l=>u===l.id)):(a.value=!1,null)}return(u,l)=>(B(),z("div",ge,[M(pe,ae({latlng:ne(o)},{sheetHeight:e.bottomSheetHeight,showCurrentLocate:e.showCurrentLocate,locate:e.latlng,removeControls:e.removeControls}),{bottomSheet:x(({props:c})=>[M(_e,{show:a.value,data:f(c)},{default:x(s=>[O(u.$slots,"bottom-sheet",I(j(s)))]),_:2},1032,["show","data"])]),_:3},16,["latlng"])]))}});var Be=V(ye,[["__file","D:/tapp/ftma_app2/src/components/Map/index.vue"]]);export{Be as M};
